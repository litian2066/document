# Search API

+ URI Search
  + 在URL中使用查询参数
+ Request Body Search
  + 使用Elasticsearch提供的，基于Json格式的更加完备的Query Domain Specific Language（DSL）

## 指定查询的索引

| 语法                   | 范围              |
| ---------------------- | ----------------- |
| /_search               | 集群上所有的索引  |
| /index1/_search        | Index1            |
| /index1,index2/_search | Index1和Index2    |
| /index*/_search        | 以index开头的索引 |

## URI Search

+ 使用"q"，指定查询字符串
+ "query  string syntax"，KV键值对

![image-20220510111709836](/Users/litian/Documents/lian2077/documents/documents/Elastic-Search/Elastic核心技术与实战/images/image-20220510111709836.png)

## Request Body

![image-20220510111757482](/Users/litian/Documents/lian2077/documents/documents/Elastic-Search/Elastic核心技术与实战/images/image-20220510111757482.png)

## 搜索Response

![image-20220510111849752](/Users/litian/Documents/lian2077/documents/documents/Elastic-Search/Elastic核心技术与实战/images/image-20220510111849752.png)

## 搜索的相关性Relevance

+ 搜索是用户和搜索引擎的对话
+ 用户关心的是搜索结果的相关性
  + 是否可以找到所有相关的内容
  + 有多少不相关的内容被返回了
  + 文档的打分是否合理
  + 结合业务需求，平衡结果排名

![image-20220510112016488](/Users/litian/Documents/lian2077/documents/documents/Elastic-Search/Elastic核心技术与实战/images/image-20220510112016488.png)

## Web搜索

>  web搜索结果往往不只是内容，更是内容是否可信，并基于内容可信度进行排名。

+ Page Rank算法
  + 不仅仅是内容
  + 更重要的是内容的可信度

![image-20220510112541351](/Users/litian/Documents/lian2077/documents/documents/Elastic-Search/Elastic核心技术与实战/images/image-20220510112541351.png)

## 电商搜索

+ 搜索引擎扮演-销售的角色
  + 提高用户购物体验
  + 提升网站销售业绩
  + 去库存

![image-20220510112656311](/Users/litian/Documents/lian2077/documents/documents/Elastic-Search/Elastic核心技术与实战/images/image-20220510112656311.png)

## 衡量相关性

在计算机里面有一门学科叫，里面有许多指标来衡量数据的相关性。

+ Infomation Retrieval
  + Precision（查准率） - 尽可能返回较少的无关文档  
  + Recall（查全率）- 尽量返回较多的相关文档 
  + Ranking -  是否能够按照相关度进行排序

## Precision & Recall

![image-20220510112813484](/Users/litian/Documents/lian2077/documents/documents/Elastic-Search/Elastic核心技术与实战/images/image-20220510112813484.png)